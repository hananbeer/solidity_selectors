import sys
import sha3
import json
import requests

ETHERSCAN_API = r'https://api.etherscan.io/api?module=contract&action=getabi&address=%s'

def get_abi(addr):
  data = requests.get(ETHERSCAN_API % addr).json()
  return json.loads(data['result'])

all_selectors = {}

# contracts taken from Google Search: "Contract Source Code" site:etherscan.io/address
# a=[];for (link of document.links) if (link.href.startsWith('https://etherscan.io/address')) a.push(link.href.substr(29,42));console.log(JSON.stringify(a))
contracts = [
    "0x13374200c29C757FDCc72F15Da98fb94f286d71e","0xdd9fd6b6f8f7ea932997992bbe67eabb3e316f3c","0xf1f955016ecbcd7321c7266bccfb96c68ea5e49b","0x0a76aad21948ea1ef447d26dee91a54370e151e0","0x6b4c7a5e3f0b99fcd83e9c089bddd6c7fce5c611","0x7be8076f4ea4a4ad08075c2508e481d6c946d12b","0x7e291890b01e5181f7ecc98d79ffbe12ad23df9e","0x01aac5236ad205ebbe4f6819bc64ef5bef40b71c","0x6684977bbed67e101bb80fc07fccfba655c0a64f","0x0c62278e1ceaaee41e3b601047cd9a89f49c8c24","0xbf4ed7b27f1d666546e30d74d50d173d20bca754","0xf9ba0955b0509ac6138908ccc50d5bd296e48d7d","0x8d12a197cb00d4747a1fe03395095ce2a5cc6819","0x95ad61b0a150d79219dcf64e1e6cc01f0b64c4ce","0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2","0x1337def16f9b486faed0293eb623dc8395dfe46a","0x06012c8cf97bead5deae237070f9587f8e7a266d","0xdac17f958d2ee523a2206206994597c13d831ec7","0x0d8775f648430679a709e98d2b0cb6250d2887ef","0x375ea781c49eafedde07afe6196f885761f166ae","0xc2c747e0f7004f9e8817db2ca4997657a7746928","0xf99d58e463a2e07e5692127302c20a191861b4d6","0xc00e94cb662c3520282e6f5717214004a7f26888","0xb932a70a57673d89f4acffbe830e8ed7f75fb9e0","0x81aa9c077d3b82f4feae27855d2e5a1dbf7e0eae","0xb3775fb83f7d12a36e0475abdd1fca35c091efbe","0x8754F54074400CE745a7CEddC928FB1b7E985eD6","0xa7bad60aa9f853b4f3195c6964e4464eae078410","0x863df6bfa4469f3ead0be8f9f2aae51c91a907b4","0xeb3a9c56d963b971d320f889be2fb8b59853e449","0x0bc529c00c6401aef6d220be8c6ea1667f6ad93e","0xb8c77482e45f1f44de1745f52c74426c631bdd52","0x389999216860ab8e0175387a0c90e5c52522c945","0x3d9819210a31b4961b30ef54be2aed79b9c9cd3b","0xc4de189abf94c57f396bd4c52ab13b954febefd8","0x2f141ce366a2462f02cea3d12cf93e4dca49e4fd","0x5acc84a3e955bdd76467d3348077d003f00ffb97","0x5d4d57cd06fa7fe99e26fdc481b468f77f05073c","0x18aAA7115705e8be94bfFEBDE57Af9BFc265B998","0x83e6f1e41cdd28eaceb20cb649155049fac3d5aa","0xbb9bc244d798123fde783fcc1c72d3bb8c189413","0xC9A1757A52F2E87A2144c8b8Ec9CB075C8b50B35","0x580237fabf94df054f68ed0c7494617bcddb1ad8","0x9e777e5dd5ee8602d3d2c0de7c507271bc1192aa","0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48","0xc3e777f1a1717be8d68300593d8bf83c33dd02f2","0x495f947276749ce646f68ac8c248420045cb7b5e","0x67bc218f5ea919ff9003b28c1702d468312af302","0x960b236a07cf122663c4303350609a66a7b288c0","0x00000000219ab540356cbb839cbe05303d7705fa","0x5d932d8348ec2bd4df7e25095760f95624640538","0xa0246c9032bc3a600820415ae600c6388619a14d","0xb11773ea2c7b9586d9efa1438ce95aba22595a7e","0x049a0b974add339d04565f6e407edfdd95218d3e","0x0a50C93c762fDD6E56D86215C24AaAD43aB629aa","0x89b21216c777065662ea72fe25795a67655e66f8","0x8a91c9a16cd62693649d80afa85a09dbbdcb8508","0x2b591e99afe9f32eaa6214f7b7629768c40eeb39","0xb6c28a66b131d7ecc5406769653653c4f108115e","0x1023ab43b917B9589b19d4290a5ACDa8b103f13d","0xd1ec43b9d44338a4e74f3f41cd1b86254cbaa874","0x87f74b6d00dd8bd8ff6e3b805bda09ca34390258","0xdeceac4cbb3e30a40091e7d73d0a16ddf88f1c6d","0x471cd7a690b752e13826bbf3745a9111c66906f5","0x89b21216c777065662ea72fe25795a67655e66f8","0xDecade1c6Bf2cD9fb89aFad73e4a519C867adcF5","0x26d46bE21CCDFe3a6EC445f292995C337e3F6B7E","0xb19c90ed52b7d65ff5ef03447bff3cb40bca08d6","0xf2c666fc90d3ebeb95922c020243493b9f5545c2","0x7582562aeeb50d6e48fa5415d47d5ccd9bd221c4","0xea4df374e6b7b3772bb5f98cea1a22606a9eb54c","0x0cbc9b02b8628ae08688b5cc8134dc09e36c443b","0x87a3d34e694cf061cd98cdf1621ca8945679337d","0xead62adc337633c50b8e2e829d4ec835678805a7","0x6e94aac24284abaf1f2f6539e77068d3c4729851","0xb6ed7644c69416d67b522e20bc294a9a9b405b31","0x23e012c683624d4ca63410840c01bfb02ee41585","0xe8d42eb7358d8ee306cf6916aae5b2367d1fed46","0x2f04664b18fb9b6d49124fcc876b52a4ba797718","0xe5FdBab9Ad428bBB469Dee4CB6608C0a8895CbA5","0x2a0c0dbecc7e4d658f48e01e3fa353f44050c208","0xd46ba6d942050d489dbd938a2c909a5d5039a161","0xcf8335727b776d190f9d15a54e6b9b9348439eee","0x1522900b6dafac587d499a862861c0869be6e428","0xbf4d21692c63df77c8fcdfc5ff90dd9d1c37ac8a","0xb47e3cd837ddf8e4c57f05d70ab865de6e193bbb","0x2f6321db2461f68676f42f396330a4dc4a8f49df","0x12459c951127e0c374ff9105dda097662a027093","0x18e1b664c6a2e88b93c1b71f61cbf76a726b7801","0x84dc33d1f2b2f4284cf9680c3085f7816248bc07","0xd4261191cfe65c40d3981846cd3d968b565c027a","0x1073c94a9c54165a8b8de32a6ff0204bbf3fcf6c",
    "0x773b42543ba7cf82b4adec0fc3c90cb6839da536","0xBC5Fab00FC2DE2b788f805eAaB46EDDfB7B03932","0xbD3EA835c91326664B10B80e710889fD14488fc2","0x6e8a8a0de641161b306cd548710c6175546faf76","0xd8eab6642265d5a1ba1c7ab20d9ce2d26afd8d15","0x90818f3cfd5a1692183785daf1cd20c95a86ba3e","0xB3698132Ac8192BEe35A012bB4BF0A9721d72aDb","0xbd050d8555ee7c8c0ccc343b541e9ed02eeeee05","0xd17C31De7eb280016001f87F5E0Efd0146fC3cc1","0x9902be4a0d4392915fa59742c9ee0cdc202ca9a4","0x2e4d2a597a2fcbdf6cc55eb5c973e76aa19ac410","0xc242eb8e4e27eae6a2a728a41201152f19595c83","0x7cDce8f97AFf2F38a9C6A6c9f139998f7A79fA43","0x28887c3E2e9E16cb9353490f4E820B26EF77860F","0xcfdbe7f11527cfc9c5a10445d54e367d946f5437","0x26d3e02999beffaeb07af3a94438769df0ee4150","0x9CA8739BB37b683A200C94C66C693e55689167ae","0x3882a1e71636c4d5896af656793cb358e6e9713f","0xEF5B27207bD9Cd7B7708755CDF1A4523CB0b1f7D","0x6c1c434a06e111a1488edf7ff119126808c1c680","0x49C822EdCD0Acd5e2b41834a0C2c716A8F0A106C","0x6fec30aecd203c9711f2b33793c0e16ee683a1c0","0xd26114cd6ee289accf82350c8d8487fedb8a0c07","0xE49DB6b293CD5b9BbFfA6c4F541C1F0A986A68a0","0x33c158f5aa02890c507c11b62adf47641d43d3ad","0x308296655e423D7E9253e06320b954fa9119F6E6","0xf890b733bd331b5658372bcc10692c5fff240584","0x7581a9961532eaa6F4157a0F3D1B318c5b0BD045","0xc811597463a2A5ec2dda2291fF3F35938dE48702","0x580237fabf94df054f68ed0c7494617bcddb1ad8","0x8296d435896bFD17EFa465D011a5A531b16579a7","0xae341082c522e43c47888f25a935cfd956cdc246","0xb00cfc5964c3fb9abde77c514a5533f9c4bd457d","0x583a73e06be2e6b37acfef367340794059eb965d","0x8163b28b0e1b8c9b9fcb338e635bf2590d187744","0x288a1f73Beee6e4d0579747E26D23d065cacF4D1","0xd9889b8649E8CC758782490229eb4F7F9A1d64d9","0x6d3a8150407efb9f3dd8b45882732bb516540824","0xe9C175b649F34438b26B8894b3ccB0590f9790D2","0x31b70005ca21086f960cdf011f9889c42641f09a","0x46c3670e12edd16a2bb0d4e729e2eacf0656c705","0x457cC3c7D0E0f0Dd01abEaB221cd8f99fAA0099C","0x1281669900f7f412680d6649b0dcc49e892ed8f8","0x0dd43633ea2210c7fa5ff78fe9ac014d06eb3002","0x04152bd6787b5b4acfa47f42fc610540c9a9e575","0xc7a7a2896d6aa5e7770fbd5be6783322c51586bf","0x5510cC0d3A5a4417BeF88E86575046BeE17a3775","0x44A7E237B72B62B967418744C895ECDD58C00DE2","0x8a01a027cbee6f0f5076cdb4add7b0211d398fe9","0xc0fd9dd98742ae9c7f5378ee6f7c17a65103c8d1","0xd56A122B1C52a76BDBEf0659D94b3027e1856d76","0xb8c7842b4451c440f14f0ccfa7cc4bb9734e5df5","0x8fDDC81DFEbd4263BE5266Fed3a079598dfCe870","0x31b3c4e729a911ee34468cb64f85e1cf95332b79","0x4B094858CF18D2a7C5a50C5f9983e0a84b66f793","0x4a2d2ab7c8c13bde51ab9921bf7522917633909e","0xb718339A3b090d68a91Ca80cEf7AdF8A69ff2421","0x1f4a27b5f888a119a5cc4a23fdb45ab7112547a5","0x9705c71b97c5cc992229153e36bcd8a366821a29","0x91ad28fd3ac749c8ff143c912743dd85700d05da","0xcdf2f4ef9c7a84555eef60bde1470bdfa01dc55f","0xa74476443119A942dE498590Fe1f2454d7D4aC0d","0x4bcea5e4d0f6ed53cf45e7a28febb2d3621d7438","0xc90e320ad970f2cb2d7908715d8310340a2948c5","0x68ed60ac40acaa99445656e652a8fd2c0e343332","0x6af75110babe08ce763b4df17aa98070e64f636f","0x91478d6de81128a75e6e4bcd1a1168a6767753a3","0xb55314af78557a54f2b5fd025e2abf8a139ac8ca","0x2911f8e60ef82bd7fd15fb3992337caacefca47f","0xff9DC0e5D38e9D0c19438C68e3730dF3EBdd6fA5","0xfe6569ce46ce4b8df585ce42f74abe3829c865f9","0x9FE125C3A94A8Ce3a0097a83Ff4D4AB7103f9A25","0xa1cd9421a58cdcfd3153bc4f52b36f4b66f5840e","0xfbe301330c29a938057ecdffa56e214cdd60e718","0x7c7663bfa7123ded0f2b646f4aa6b78b0eac9436","0xA1c8031EF18272d8BfeD22E1b61319D6d9d2881B","0xC48Dc7FE57f1Df961EC6d7c2c814c07EeD99e490","0x9867e2db8179a6e5968dc7d67ebd38aa6826112c","0xB871d3CCf8c8ba9B93a5e391C2bfaa18a8fa4AF0","0x6bcc5acfbcf93139d8d129690e0319c27b0926a3","0x3b7d285d12047c26967435f761c0bc71a7c7e2b7","0xeb461397c212a935bfc534fbb43da745d0c7adbe","0xe3b9fe9b14a1fe7ee6646fef30c32864ca0a3596","0xe644b00b820b16c791149e633af13cccc7685a04","0x9bef2c65fd77cf54040c7691165c87b76d17163f","0x8a478036695be9f6447f00085ba158a88864dc52","0x19E6BF254aBf5ABC925ad72d32bac44C6c03d3a4","0x1224917a739dff52c50b232042cc1b196d2daced","0xd85765d80540585d49d7dfcda1352fe668b139aa","0xe35246b2afdd1762941e5e8f3b10415de0a6659a","0x209dcdb64629acad803f0fd2076d485f3e3ae4fa","0x2303da40dac5071a4c2f73a1e612fed4bf902699","0x7D8E28184408Bc4790E79Fd08ED67f7eBaCBEbcc","0xC616420bDb355b36C2718D2471739A14f5E40e57","0x3debc687e00764f0ded0caae999c86fa97d6ddd8","0x1464504dfddd1539b7963ccd8adef2f41adf6b56","0x5180545835bd68810fb7e11c7160bb7ea4ae8744","0xce7ae8dee3a4126cee7f8f356ee8d4190efaeadd",
    "0x84dc33d1f2b2f4284cf9680c3085f7816248bc07","0xd4261191cfe65c40d3981846cd3d968b565c027a","0x1073c94a9c54165a8b8de32a6ff0204bbf3fcf6c","0xd654bdd32fc99471455e86c2e7f7d7b6437e9179","0x4e8056dfe7124a74acb23244e3e24110e2af0a98","0xa185B9E63FB83A5a1A13A4460B8E8605672b6020","0x990f341946a3fdb507ae7e52d17851b87168017c","0xe11609b9a51caf7d32a55896386ac52ed90e66f1","0xdd5C14f6eC5281ca7Bd2AD3c6934bEE7fEDd6d1B","0x0947b0e6D821378805c9598291385CE7c791A6B2","0x48a3f29d3548ef36d4b223ed345789c8e867af3c","0x0affa06e7fbe5bc9a764c979aa66e8256a631f02","0x2B90FA38BC600b1cE811B47022C9fDb962fDDFd7","0x747fe3e7a78ed65a059b4d4cb7adedaac7318050","0xc6eebd4a45a8ff06c7e26365dde2c0dfc488da36","0x57DD1068C7971832b80fB7D7A76b92bf490d3991","0x837704ec8dfec198789baf061d6e93b0e1555da6","0x59E3b1e13a04444816CdA211962A217997931986","0xa751c2005978184e8664f690118f8ecd109aa7e7","0x31AF195dB332bc9203d758C74dF5A5C5e597cDb7","0x572f629ffc8cd4a90d6da466d0d72200cfb1d57e","0x7c5aFcFdF14a54d91662A1e230789DCb650C3FaA","0xe448c94856b36ffb701FB5A578452d32F52788ea","0x77Be140EA70FCd0532fd452dE5c29eC395a43FFa","0x7097bc88487559d3495de0FdC062F38efCBb865e","0x502c4bfdab2d5bc84f01e6fcc2b5be38261ab63d","0xDc153c14199ee94a3b0537F4ED2AFfE50a6C811B","0x2980bd7128AF03e0a99ae354d9bE81DBa22f8d6E","0x2f9b6779c37df5707249eeb3734bbfc94763fbe2","0xd26114cd6ee289accf82350c8d8487fedb8a0c07","0xf050ff9dcde139583e60bb53fdb1b6eb8413dcc3","0x472bedd0f4de2573bae522546940c93ae37c5b21","0x3014ca10b91cb3D0AD85fEf7A3Cb95BCAc9c0f79","0xaee5fa6c12a46f48023380ade2c07ccdc550bba7","0x0490cb40228dddca22dbd7f51738c928465ff3f4","0xd98db983fa7cbd21fd24ac84c9aca430191309c2","0x45c2d0d755431e1410c121af2c819b292244c525","0x36774fbca6b17325947cb208f77b4871ac7b6217","0x17b1ccd6b0066322a0c3e9d54e82a9429556effb","0x035d029839d7cdc1f111dcfb6303d763459a46dc","0x829a028a13e89545b1736b37605a2df6d1580dbe","0xa74476443119A942dE498590Fe1f2454d7D4aC0d","0x63693bFf068234f7751c8459F884066c3cFc31ED","0xfb31b594d381814009bfcb78cacae396eccb7270","0x0D59Ae1aF62ceeF6F31F38dF881911b408e114bc","0x7c7663bfa7123ded0f2b646f4aa6b78b0eac9436","0x3c065f2713ea9b1e7ac563c11612ee93d3682c1a","0xd7a024bfb5efdc1ccdbaad7ef3baed3a59549c40","0x6cf7f9b6bf1f806dbd94c6391fff773c90889eef","0x7e959fD31403216e5DddACDc677B7dc82F6B4a94","0xb11ceec1ebb56653f38e5b0d0c6977df51ab6a4f","0x34a77Aa9AE42ff9a9B2078E450651D112D5BE908","0xf732a0fea0728e8b2303166da58c1a2c332ff7ab","0x1A98a2dC31B573B0A241bdecfCAAEda9dA9fa73b","0x9a7956dff83d5e94e8b4e9c6bbd7a40a9c89ebf7","0x21e6777cf0c49ea3beabb33ff0ef4da9ddb982d5","0x2cbc6812cff0b1113bf2808ffce6d83b97afd345","0xB061021d6eC56942e6869EEDe86aF3Ca617dFD0c","0x66497a283e0a007ba3974e837784c6ae323447de","0x422Cf367028dE0D3d5AF9a7e3Cb62D6AcD17165D","0xe31264d278e084dbb5eb07925051548cd9027fa3","0xd257ba04472038926b8c5a85122be3e486055692","0xf197d06cb0b6ab8adccfd471cacc27d429d0e00f","0x105148da16a00ea1d282305bb5da17cd2145ada3","0xf4166ADf45e2cc59d104aAAec0B1096F6f8fd129","0x16e42363147f1823d72f2ea8d2807f53a32bb45b","0x1805a6223fc8b4a832b026047524ec6659e7dc39","0xC4e1c9816efC94d247E828BFAae77Bf92aF2e68C","0x035B2Dd74a78f877616b4F265C0d36b98527467A","0xe725c319cb838de8a52ebca7c7247642c0ae363d","0xe3df3a1ef861b9ac1c809c8e549a739d1f9d2a72","0x43820f75f021c34ce13ded1595633ed39b79ab47","0x5d5dda5f1c0b284f78a3ce04b4bb8ff5de77f52d","0x61404d2d3f2100b124d6827d3f2ddf6233cd71c0","0x0491453518694325779a2ab3e02987b1370bc19d","0xC5BcA3b74F5ab61c2C8B4e47e1fef188Bb4a3dCa","0x33aD8CCD192c2B1782b0d3E557e32a54771E16F1","0x4d590374378cc72db4382e27f5b4ecaf459f4d2f","0x125Ac71f194CDE29E8F2a104A04EA67779c91751","0x08ff7e2be3c23ab3938b6d275193d6a49ccef73e","0x62678263b1c512ddaf153cc05105866ba4330a3a","0x79df33c550158c99ab98b585b1688bfffe1099cf","0xf45259e9d210eee07048cae66102c3b4050a5b05","0x746864ceb8b7eef1bc8fd3e2d8a5cb2a8603f433","0x4BA6B2fF35055aF5406923406442cD3aB29F50Ce","0x96dc0af2a77e4b185e5fe6cbfdb21f281e17c733","0x55fb1fd92e56f10652ec548b1473902794a09d7e","0x0fdec7fc8086685703006ce4df0e65b1063c3b4f","0x601D99c441C1cB4327a34D971ca15d036b95d766","0x1d6aa0045a56f05f8c5d81defd5f641bc321552e","0xc909845c908B813A73bfa5B45413C7fc61e6d70d","0x94e7b5e146a5e7a693255bf3a46a13120df5482e","0x294f999356ed03347c7a23bcbcf8d33fa41dc830","0x21fb25ca32e97603d903a89f9c2ee3b4657af665","0x4f9309619d2d2b1501284208ecc1cd7e4537add1","0x5a7e644b8bcd6e9b0e67ee9c147094b808a4f3e2","0x6b5dc6e4db6559f2aa7ef2590bd5f5d94bcd7ab9","0x7895879e0ec1fb2e9a3fc3ac97e8908c2c519f7e"
    "0x1a40abf86c6c7638c141335859c367355c583827","0x0ea42ded76b6dee3cca92fa4f71729a32ff35c9a","0xc29736f5165ec7007dbb2c8824751500a4d472bd","0x39d4b22d62107372a12453fbb4671f2f1208916f","0x229fe399850491f4687eb1bc840a6fd2bc11020b","0xd47eceec3f26607b24491cf860f637cd9437776c","0x2f79cb4e2d43441a4e8261542c7b1a76abeb99c0","0x77673ce54c88aa2adcfa904a0d2886bdae41e996","0x43d2eaf5411719a934731ee2569f96534a9bf538","0x4a453df93535f6baa8dc3cb1b0c032289da3bd16","0x64b986211c0cc675143f895c437b79c3cadf364a","0xd21730353086b0d6c34656ca74f4e4295dc9b8e0","0x3D41675D0E5B610CfEA98998129780753bD664b5","0xb62132e35a6c13ee1ee0f84dc5d40bad8d815206","0x503f7065978c3b521e25d8b4a819b7bef6108a9e","0x42b71288fe55b1a3857ecc1b28614cf56272ade7",
]

for c in contracts:
  print('downloading abi for: %s' % c, file=sys.stderr)
  try:
      abi = get_abi(c)
  except Exception as e:
    print('error for %s: %s' % (c, e), file=sys.stderr)
    continue

  for item in abi:
    if item['type'] != 'function':
      continue

    # TODO: should be 'type' or 'internal_type'??
    types = ','.join([i['type'] for i in item['inputs']])
    selector = '%s(%s)' % (item['name'], types)
    hash = sha3.keccak_256(selector.encode()).hexdigest()
    
    # TODO: handle collisions & link to relevant contract
    all_selectors['0x%s' % hash[:8]] = selector

print(json.dumps(all_selectors))
